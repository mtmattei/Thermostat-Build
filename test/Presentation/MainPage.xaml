<Page x:Class="test.Presentation.MainPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:local="using:test.Presentation"
      xmlns:utu="using:Uno.Toolkit.UI"
      NavigationCacheMode="Required">

	<Page.Resources>
		<!-- Reusable gradient for glassmorphic borders -->
		<LinearGradientBrush x:Key="GlassBorderBrush" StartPoint="0,0" EndPoint="1,1">
			<GradientStop Color="#40FFFFFF" Offset="0" />
			<GradientStop Color="#10FFFFFF" Offset="0.5" />
			<GradientStop Color="#05FFFFFF" Offset="1" />
		</LinearGradientBrush>

		<!-- Background gradient -->
		<LinearGradientBrush x:Key="PageBackgroundBrush" StartPoint="0.5,0" EndPoint="0.5,1">
			<GradientStop Color="#000000" Offset="0" />
			<GradientStop Color="#0A1520" Offset="0.3" />
			<GradientStop Color="#1A1530" Offset="0.7" />
			<GradientStop Color="#2D1B4E" Offset="1" />
		</LinearGradientBrush>
	</Page.Resources>

	<Grid Background="{StaticResource PageBackgroundBrush}">
		
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto" />
			<RowDefinition Height="*" />
		</Grid.RowDefinitions>

		<!-- Header Section -->
		<Grid Grid.Row="0" Padding="20,48,20,16">
			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="Auto" />
				<ColumnDefinition Width="*" />
				<ColumnDefinition Width="Auto" />
			</Grid.ColumnDefinitions>
			
			<Button Grid.Column="0"
					Width="40"
					Height="40"
					Background="Transparent"
					BorderThickness="0"
					Padding="0"
					HorizontalContentAlignment="Center"
					VerticalContentAlignment="Center">
				<FontIcon Glyph="&#xE700;"
						  FontSize="20"
						  Foreground="White"
						  FontFamily="Segoe MDL2 Assets" />
			</Button>
			
			<TextBlock Grid.Column="1"
					   VerticalAlignment="Center"
					   HorizontalAlignment="Left"
					   Margin="12,0,0,0"
					   FontSize="18"
					   FontWeight="Normal"
					   Foreground="White">
				<Run Text="{x:Bind ViewModel.GreetingText, Mode=OneWay}" />
				<Run Text=", User" />
			</TextBlock>
			
			<Grid Grid.Column="2" Width="40" Height="40">
				<Ellipse Width="40"
						 Height="40"
						 Translation="0,0,16">
					<Ellipse.Fill>
						<LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
							<GradientStop Color="#50FFFFFF" Offset="0" />
							<GradientStop Color="#15FFFFFF" Offset="0.5" />
							<GradientStop Color="#08FFFFFF" Offset="1" />
						</LinearGradientBrush>
					</Ellipse.Fill>
					<Ellipse.Shadow>
						<ThemeShadow />
					</Ellipse.Shadow>
				</Ellipse>

				<Button Width="40"
						Height="40"
						Background="Transparent"
						BorderThickness="0"
						Padding="0"
						HorizontalContentAlignment="Center"
						VerticalContentAlignment="Center">
					<FontIcon Glyph="&#xE713;"
							  FontSize="20"
							  Foreground="White"
							  FontFamily="Segoe MDL2 Assets" />
				</Button>
			</Grid>
		</Grid>

		<!-- Main Content -->
		<ScrollViewer Grid.Row="1" 
					  VerticalScrollBarVisibility="Auto">
			<utu:AutoLayout Padding="20" Spacing="32" Orientation="Vertical">

				<!-- Circular Thermostat Display -->
				<Grid HorizontalAlignment="Stretch">
					<Border Width="380"
							Height="380"
							MaxWidth="380"
							HorizontalAlignment="Center"
							CornerRadius="190"
							Padding="2"
							Translation="0,0,32"
							Background="{StaticResource GlassBorderBrush}">
						<Border.Shadow>
							<ThemeShadow />
						</Border.Shadow>

						<Border CornerRadius="188">
							<Border.Background>
								<SolidColorBrush Color="{ThemeResource CircleFill}" Opacity="0.6" />
							</Border.Background>

							<local:ThermostatRenderer Progress="{x:Bind ViewModel.CurrentProgress, Mode=TwoWay}"
												  CurrentTemperature="{x:Bind ViewModel.Thermostat.CurrentTemperature, Mode=OneWay}"
												  StatusText="{x:Bind ViewModel.StatusText, Mode=OneWay}" />
						</Border>
					</Border>
				</Grid>

				<!-- Information Cards -->
				<Grid ColumnSpacing="16">
					<Grid.ColumnDefinitions>
						<ColumnDefinition Width="*" />
						<ColumnDefinition Width="*" />
						<ColumnDefinition Width="*" />
					</Grid.ColumnDefinitions>
					
					<ItemsRepeater Grid.ColumnSpan="3" 
								   ItemsSource="{x:Bind ViewModel.Metrics, Mode=OneWay}">
						<ItemsRepeater.Layout>
							<UniformGridLayout Orientation="Horizontal" 
											   MinItemWidth="100" 
											   ItemsStretch="Fill" 
											   MinColumnSpacing="16" />
						</ItemsRepeater.Layout>
						<ItemsRepeater.ItemTemplate>
								<DataTemplate>
									<Border CornerRadius="16"
											Padding="1"
											Translation="0,0,24"
											Background="{StaticResource GlassBorderBrush}">
										<Border.Shadow>
											<ThemeShadow />
										</Border.Shadow>
										
										<Border CornerRadius="15"
												Padding="16">
											<Border.Background>
												<SolidColorBrush Color="{ThemeResource CardBackground}" Opacity="0.5" />
											</Border.Background>

											<Grid RowSpacing="8">
												<Grid.RowDefinitions>
													<RowDefinition Height="Auto" />
													<RowDefinition Height="Auto" />
													<RowDefinition Height="Auto" />
												</Grid.RowDefinitions>

												<FontIcon Grid.Row="0"
														  Glyph="{Binding Icon}"
														  FontSize="24"
														  HorizontalAlignment="Left"
														  FontFamily="Segoe MDL2 Assets">
													<FontIcon.Foreground>
														<SolidColorBrush Color="{Binding IconColor}" />
													</FontIcon.Foreground>
												</FontIcon>

												<StackPanel Grid.Row="1"
															Orientation="Horizontal"
															Spacing="4"
															HorizontalAlignment="Left">
													<TextBlock Text="{Binding Value}"
															   FontSize="28"
															   FontWeight="SemiBold"
															   Foreground="White"
															   VerticalAlignment="Center" />
													<TextBlock Text="{Binding Unit}"
															   FontSize="16"
															   Foreground="#A0A0A0"
															   VerticalAlignment="Center" />
												</StackPanel>

												<TextBlock Grid.Row="2"
														   Text="{Binding Label}"
														   FontSize="12"
														   Foreground="#A0A0A0"
														   HorizontalAlignment="Left" />
											</Grid>
										</Border>
									</Border>
							</DataTemplate>
						</ItemsRepeater.ItemTemplate>
					</ItemsRepeater>
				</Grid>

				<!-- Energy Usage Chart -->
				<Border CornerRadius="20"
						Padding="1"
						Translation="0,0,24"
						Background="{StaticResource GlassBorderBrush}">
					<Border.Shadow>
						<ThemeShadow />
					</Border.Shadow>
					
					<Border CornerRadius="19" 
							Padding="16">
						<Border.Background>
							<SolidColorBrush Color="{ThemeResource CardBackground}" Opacity="0.4" />
						</Border.Background>
					
						<utu:AutoLayout Spacing="16" Orientation="Vertical">
							<utu:AutoLayout Spacing="12" Orientation="Horizontal">
								<FontIcon Glyph="&#xE945;" 
										  FontSize="20" 
										  Foreground="White" 
										  VerticalAlignment="Center" />
								<TextBlock Text="Energy Usage" 
										   FontSize="16" 
										   FontWeight="SemiBold" 
										   Foreground="White" 
										   VerticalAlignment="Center" />
							</utu:AutoLayout>
						
							<local:ChartRenderer Data="{x:Bind ViewModel.EnergyData, Mode=OneWay}" />
						</utu:AutoLayout>
					</Border>
				</Border>

			</utu:AutoLayout>
		</ScrollViewer>
	</Grid>
</Page>